# 技术选型方案

## 项目概述
「每日打卡Pro」微信小程序 - 多场景轻量化打卡工具

## 技术栈选型

### 前端技术栈

#### 框架：uni-app (Vue 3)
- **选择理由**：
  - 跨平台开发能力，一套代码可发布到微信小程序、H5、App等多端
  - 完善的微信小程序适配，原生API调用便捷
  - Vue 3 组合式API提供更好的代码组织与复用能力
  - 丰富的插件生态（日历组件、图表组件等）
  - 官方维护稳定，社区活跃

#### UI框架：uni-ui
- 官方UI组件库，提供基础组件保证风格统一
- 支持按需引入，减小包体积

#### 状态管理：Pinia
- Vue 3 官方推荐的状态管理方案
- TypeScript支持良好
- API简洁，学习成本低

### 后端技术栈

#### 框架：NestJS
- **选择理由**：
  - 基于 TypeScript，类型安全
  - 模块化架构，便于维护和扩展
  - 依赖注入，提高代码可测试性
  - 内置支持 WebSocket、GraphQL、微服务
  - 与 Prisma ORM 集成良好
  - 类似 Angular 的架构，开发者上手快

#### ORM：Prisma
- **选择理由**：
  - 类型安全的数据库访问
  - 自动生成 TypeScript 类型定义
  - 数据库迁移管理便捷
  - 查询API简洁直观
  - 支持关系型数据库（MySQL）
  - 可视化 Prisma Studio 工具

#### 数据库：MySQL
- **选择理由**：
  - 成熟稳定，社区支持广泛
  - 免费开源，成本可控
  - 性能优秀，适合中小规模应用
  - 支持事务、索引等完整特性
  - 云服务支持丰富（阿里云RDS、腾讯云MySQL等）

### 部署与运维

#### 前端部署
- 微信小程序平台（发布至微信小程序商店）
- H5版本可部署至 CDN 或静态服务器

#### 后端部署
- Docker 容器化部署
- 云服务器（阿里云/腾讯云）
- Nginx 反向代理

#### 数据库
- 云数据库（阿里云RDS MySQL / 腾讯云MySQL）

### 开发工具

#### 前端
- HBuilderX：uni-app 官方 IDE
- VS Code + uni-app 插件

#### 后端
- VS Code
- Prisma Studio：数据库可视化管理

## 技术架构图

```
┌─────────────────────────────────────────────────────────┐
│                      客户端层                             │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ 微信小程序   │  │   H5 Web    │  │  移动端 App  │  │
│  │  (uni-app)  │  │  (uni-app)  │  │  (uni-app)  │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                      API 网关层                           │
│                    (Nginx 反向代理)                        │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                    后端服务层                             │
│                   (NestJS Application)                    │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  │
│  │ 用户模块 │  │ 打卡模块 │  │ 社交模块 │  │ 激励模块 │  │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘  │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                    数据访问层                             │
│                      (Prisma ORM)                        │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│                    数据存储层                             │
│                     (MySQL 数据库)                        │
└─────────────────────────────────────────────────────────┘
```

## 核心模块设计

### 前端模块结构
```
src/
├── pages/              # 页面
│   ├── index/          # 首页
│   ├── community/      # 打卡圈
│   ├── team/           # 组队
│   └── mine/           # 我的
├── components/         # 组件
│   ├── CheckInCard/    # 打卡卡片
│   ├── Calendar/       # 日历组件
│   └── Medal/          # 勋章组件
├── stores/             # Pinia 状态管理
│   ├── user.ts         # 用户状态
│   ├── checkin.ts      # 打卡状态
│   └── points.ts       # 积分状态
├── api/                # API 接口
│   ├── user.ts
│   ├── checkin.ts
│   └── team.ts
├── utils/              # 工具函数
└── types/              # TypeScript 类型定义
```

### 后端模块结构
```
src/
├── modules/
│   ├── user/           # 用户模块
│   ├── checkin/        # 打卡模块
│   ├── team/           # 组队模块
│   ├── points/         # 积分模块
│   └── community/      # 打卡圈模块
├── common/
│   ├── guards/         # 守卫
│   ├── decorators/     # 装饰器
│   ├── filters/        # 异常过滤器
│   └── interceptors/   # 拦截器
├── config/             # 配置
└── prisma/             # Prisma 客户端
```

## 数据库设计要点

### 核心数据表
- `users` - 用户表
- `checkin_items` - 打卡项表
- `checkin_records` - 打卡记录表
- `teams` - 队伍表
- `team_members` - 队伍成员表
- `points` - 积分记录表
- `medals` - 勋章表
- `user_medals` - 用户勋章关联表
- `challenges` - 挑战活动表
- `community_posts` - 打卡圈动态表

## 技术优势总结

1. **开发效率**：uni-app 跨平台开发，一套代码多端运行；NestJS 模块化架构快速开发
2. **类型安全**：Vue 3 + TypeScript + Prisma 全链路类型安全
3. **可维护性**：清晰的模块划分，代码组织规范
4. **可扩展性**：NestJS 依赖注入，模块独立，易于扩展
5. **性能优秀**：Prisma 查询优化，MySQL 性能稳定
6. **成本可控**：开源技术栈，无商业授权费用

## 未来扩展方向

1. 引入 Redis 缓存热点数据
2. 消息队列处理异步任务（积分计算、消息推送）
3. Elasticsearch 支持全文搜索
4. 微服务拆分（用户服务、打卡服务等）
5. 容器编排（Kubernetes）